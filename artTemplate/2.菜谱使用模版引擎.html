<!DOCTYPE html>
<html lang="">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <script src="./jquery-3.2.1.min.js" type="text/javascript"></script>
    <style>
        *{margin:0;padding: 0;}
        #box{
            width: 200px;
            height: 100px;
            background-color: skyblue;
            margin: 30px auto;
            margin-bottom: 10px;
        }
        #showInfo {
	        width: 960px;
            margin: 0 auto;
        }
        .show-center {
            display: block;
            width: 230px;
            height: 230px;
            margin: 0 auto;
        }
        .font-red {
            color: #f50949;
            font-size: 36px;
        }
        hr {
            margin: 15px;
        }
    </style>

<script src=./artTemplate-master/dist/template-native-debug.js></script>
<script id="tpl" type="text/html">

        <% for(var i=0;i<json.result.data.length;i++) { %>
            <%= mydata%>=<%= json.result.data[i]%>
        <% } %>
</script>
<script type="text/javascript">
    $(document).ready(function(){
            
        $("#btnSearch").click(function(){
            var $menuName = $("#menuName").val();   // jqeury的方法 val(),获取收入内容
            var $showInfo = $("#showInfo");
            
            $showInfo.text("正在加载...");
            
            
            // 下面使用的jsop方式：不是httpRequest方式发的请求 而是script方式发的请求-------跨域
            $.ajax({
                type:"get",
                asyn:"true",
  url:"http://apis.juhe.cn/cook/query?key=caef02cb8ee5ca399813608e2abf9b15&rn=10&pn=3&dtype=jsonp&menu="+encodeURIComponent($menuName),
                // dtype=jsonp 必须加上 不然就访问的不是jsonp 而是默认的json了
                // 输入的菜单名大多是中文 需要encodeURIComponent() 进行URL编码
                
                // 当dataType设置为jsonp的时候，会全局的创建一个script 然后 src=url...那些
                dataType:"jsonp",  
                
                // 下面三个都可以不写
//                data:"西红柿炒蛋",   // 可以不写，因为菜单名在 url最后面动态的添加了，而且这里是get方式 
//                jsonp:"callback", //传递给请求处理程序或页面的，用以获得jsonp回调函数名的参数名(一般默认为:callback)
//                jsonpCallback:"handlefunc",//自定义的jsonp回调函数名称，默认为jQuery自动生成的随机函数名，也可以写"?"，jQuery会自动为你处理数据
                
                success:function(json){
                    // 先清空容器---主要是清空 "正在加载...."
                    $showInfo.text("");
                    // 解析数据
                    if(json.resultcode != 200) {
                        $showInfo.text("亲，没查到");
                        return;
                    }
                    // 调用模版
                    var html = template("tpl",json);
                    $showInfo.html(html);
                },
                failure:function(){
                    $showInfo.text("错误");
                },
            });
        }); 
    });
</script>    
</head>

<body>
    <div id="box">
        <form action="">
            <input type="text" placeholder="菜谱名" id="menuName">
            <input type="button" value="查询" id="btnSearch">
        </form>
    </div>
    <div id="showInfo"></div>
<!--    <img src="http://juheimg.oss-cn-hangzhou.aliyuncs.com/cookbook/t/1/307_874685.jpg" alt="">-->
</body>
</html>

